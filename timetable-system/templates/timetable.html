<!DOCTYPE html>
<html lang="en">
    <meta charset="UTF-8" />
    <title>Intelligent Timetabling System</title>
    <body>
        <table>
            <tr>
                <td>
                    <table>
                        <tr>
                            <th>Time</th>
                        </tr>
                        {% set start_time = initialtime %}
                        {% for start_time in timeRange %}
                            {% set end_time  = start_time | increment_time(1) %}
                            <tr height="30">
                                <td rowspan="6">{{start_time | timetostr}}-{{end_time | timetostr}}</td>
                            </tr>
                            {% set start_time = start_time | increment_time(1) %}
                        {% endfor %}
                    </table>
                </td>
                {% for day in days %}
                <td>
                    <table>
                        <thead>
                            <tr>
                                <td>{{ day }}</td>
                            </tr>
                        </thead>
                        <tbody>
                            {% set time = initialtime %}
                            {% for time in timeRange %}
                                {% for result in results[ day ] %}
                                    {% set str_time = time | timetostr %}
                                    {% if result["start_time"] == str_time %}
                                        {% if result["duration"] == "0:50:00" %}
                                        {% set time = time | increment_time(1) %}
                                        <tr>
                                            <td class="occupied" rowspan="5">{{ result["course"] }} {{ result["start_time"] }}-{{ result["end_time"] }}</td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                        </tr>
                                        {% elif result["duration"] == "1:50:00" %}
                                        {% set time = time | increment_time(2) %}
                                        <tr>
                                            <td class="occupied" rowspan="11">{{ result["course"] }} {{ result["start_time"] }}-{{ result["end_time"] }}</td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                        </tr>
                                        {% else %}
                                        {% set time = time | increment_time(3) %}
                                        <tr>
                                            <td class="occupied" rowspan="17">{{ result["course"] }} {{ result["start_time"] }}-{{ result["end_time"] }}</td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                        </tr>
                                        {% endif %}
                                    {% else %}
                                        <tr>
                                            <td rowspan="6"></td>
                                        </tr>
                                    {% endif %}
                                {% endfor %}
                            {% endfor %}
                        </tbody>
                    </table>
                </td>
                {% endfor %}
            </tr>
        </table>
        <form action="/">
            <input type="button" value="Search again" />
        </form>
        <form action="/pdf_timetable">
            <input type="button" value="Export As PDF" />
        </form>
    </body>
</html>